<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Emocji - Pobierz</title>
    <style>
        :root {
            --bg: #f0f2f5;
            --card: #ffffff;
            --primary: #2d3436;
            --strach: #9badd3; --gniew: #f2ccc3; --odraza: #d1e8e2;
            --smutek: #d8c8d8; --radosc: #f9f7ba; --zdziwienie: #f7d1d1;
            --wstyd: #e0aaff; --duma: #ffbe0b;
        }

        body {
            margin: 0; padding: 15px; font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg); color: var(--primary);
            display: flex; flex-direction: column; align-items: center;
        }

        .container {
            width: 100%; max-width: 500px; background: var(--card);
            padding: 20px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-align: center; box-sizing: border-box;
        }

        h1 { font-size: 1.3rem; margin: 0 0 10px 0; }
        
        .wheel-wrapper { position: relative; width: 100%; margin: 20px auto; }
        svg { width: 100%; height: auto; transform: rotate(-90deg); display: block; }
        
        .segment { cursor: pointer; transition: all 0.3s ease; stroke: #fff; stroke-width: 1; }

        #info-panel {
            margin: 20px 0; min-height: 80px; padding: 15px;
            border-radius: 12px; background: #f8f9fa; border: 1px solid #eee;
            text-align: left;
        }

        .btn-download {
            background-color: #0984e3; color: white; border: none;
            padding: 12px 24px; border-radius: 30px; font-weight: bold;
            cursor: pointer; transition: background 0.3s; width: 100%;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-download:hover { background-color: #74b9ff; }
        .btn-download:active { transform: scale(0.98); }

        canvas { display: none; } /* Hidden canvas for conversion */
    </style>
</head>
<body>

<div class="container">
    <h1>Mapa Emocji i Cia≈Ça</h1>
    
    <div class="wheel-wrapper" id="svg-container">
        <svg id="emotion-svg" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
            <rect width="400" height="400" fill="white" /> <circle cx="200" cy="200" r="35" fill="#fff" stroke="#dfe6e9" />
            <text x="200" y="200" text-anchor="middle" transform="rotate(90 200 200)" font-size="8" font-family="Arial" font-weight="bold">CIA≈ÅO</text>

            <path class="segment" d="M200,200 L200,100 A100,100 0 0,1 270,128 Z" fill="#9badd3" 
                  data-name="Strach" data-body="Zimne d≈Çonie, dr≈ºenie, szybkie bicie serca." />
            
            <path class="segment" d="M200,200 L270,128 A100,100 0 0,1 300,200 Z" fill="#f2ccc3" 
                  data-name="Gniew" data-body="Uderzenia gorƒÖca, napiƒôte miƒô≈õnie karku." />

            <path class="segment" d="M200,200 L300,200 A100,100 0 0,1 270,272 Z" fill="#e0aaff" 
                  data-name="Wstyd" data-body="Pieczenie policzk√≥w, unikanie wzroku." />

            <path class="segment" d="M200,200 L270,272 A100,100 0 0,1 200,300 Z" fill="#d1e8e2" 
                  data-name="Odraza" data-body="Md≈Ço≈õci, gula w gardle, dreszcze." />

            <path class="segment" d="M200,200 L200,300 A100,100 0 0,1 130,272 Z" fill="#d8c8d8" 
                  data-name="Smutek" data-body="Ciƒô≈ºko≈õƒá w klatce, pieczenie oczu, ≈Çzy." />

            <path class="segment" d="M200,200 L130,272 A100,100 0 0,1 100,200 Z" fill="#ffeaa7" 
                  data-name="Duma" data-body="Prosta postawa, ciep≈Ço w piersiach." />

            <path class="segment" d="M200,200 L100,200 A100,100 0 0,1 130,128 Z" fill="#f9f7ba" 
                  data-name="Rado≈õƒá" data-body="Lekko≈õƒá, motyle w brzuchu, u≈õmiech." />

            <path class="segment" d="M200,200 L130,128 A100,100 0 0,1 200,100 Z" fill="#f7d1d1" 
                  data-name="Zdziwienie" data-body="Uniesione brwi, wstrzymany oddech." />
        </svg>
    </div>

    <div id="info-panel">
        <h3 id="info-title" style="margin:0">Dotknij segmentu</h3>
        <p id="info-body" style="margin:5px 0 0 0">Zainspiruj siƒô reakcjami swojego cia≈Ça.</p>
    </div>

    <button class="btn-download" id="download-btn">
        <span>üíæ</span> Pobierz jako obraz (PNG)
    </button>
    
    <canvas id="export-canvas" width="800" height="800"></canvas>
</div>

<script>
    const svg = document.getElementById('emotion-svg');
    const segments = document.querySelectorAll('.segment');
    const panel = document.getElementById('info-panel');
    const title = document.getElementById('info-title');
    const body = document.getElementById('info-body');
    const downloadBtn = document.getElementById('download-btn');

    // Interactive logic
    segments.forEach(s => {
        const update = () => {
            title.innerText = s.getAttribute('data-name');
            body.innerText = s.getAttribute('data-body');
            panel.style.borderLeft = `5px solid ${s.getAttribute('fill')}`;
        };
        s.addEventListener('mouseenter', update);
        s.addEventListener('touchstart', (e) => { e.preventDefault(); update(); });
    });

    // Download logic
    downloadBtn.addEventListener('click', () => {
        const canvas = document.getElementById('export-canvas');
        const ctx = canvas.getContext('2d');
        const svgData = new XMLSerializer().serializeToString(svg);
        const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
        const url = URL.createObjectURL(svgBlob);
        
        const img = new Image();
        img.onload = () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, 0, 0, 800, 800);
            URL.revokeObjectURL(url);
            
            const pngUrl = canvas.toDataURL('image/png');
            const downloadLink = document.createElement('a');
            downloadLink.href = pngUrl;
            downloadLink.download = 'kolo-emocji.png';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        };
        img.src = url;
    });
</script>

</body>
</html>
